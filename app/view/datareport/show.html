<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title><?=$data['projectName']?>项目—百度信息流统计</title>
  <style>
      body {
          display: flex;
          flex-direction: column;
          align-items: center;
          margin: 0;
          font-family: '微软雅黑', Arial, sans-serif;
          min-height: 100vh;
      }

      .center-div {
          width: 90%; /* 调整为90% */
          max-width: 950px; /* 设置最大宽度为800px */
          margin: 0 auto;
          padding: 20px;
          overflow-x: auto; /* 如果表格太宽，允许水平滚动 */
      }

      h1 {
          margin: 20px 0;
      }

      table {
          width: 100%;
          border-collapse: collapse;
      }

      th, td {
          border: 1px solid #ccc;
          padding: 8px;
          text-align: center; /* 设置文本居中 */
          white-space: nowrap; /* 强制不换行 */
          overflow: hidden; /* 溢出隐藏 */
          text-overflow: ellipsis; /* 超出部分显示省略号 */
      }

      th {
          background-color: #f2f2f2;
          color: #333;
      }

      tr:nth-child(even) {
          background-color: #f9f9f9;
      }

      .header-row th, .date-row th {
          background-color: #ddd;
      }

      .title-row th {
          font-size: 1.5em; /* 增大字体 */
          font-weight: bold; /* 加粗 */
          text-align: center; /* 居中显示 */
      }

      .summary-row td {
          color: red;
          font-weight: bold;
      }

      .light-blue-column th {
          background-color: #2380fd;
          color: #fff;
      }

      .header {
          color: #fff;
          padding: 10px 20px;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }

      .header-left img {
          height: 40px;
      }

      .header-center {
          text-align: center;
          font-weight: bold;
          color: #fff;
      }

      .header-right {
          text-align: right;
          font-size: 14px;
          color: #fff;
      }

      .watermark {
          position: absolute;
          color: black; /* 水印颜色 */
          font-size: 20px; /* 水印字体大小 */
          opacity: 0.1; /* 水印透明度 */
          -webkit-user-select: none; /* 防止用户选择文本 */
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
      }
  </style>
</head>
<body>

<div class="center-div">
    <table id="myTable">
        <tr class="title-row light-blue-column">
            <th colspan="9">
                <div class="header">
                <div class="header-left">
                    <img src="/static/images/logo.jpg?456" alt="Logo">
                </div>
                <div class="header-center">
                    <?=$data['projectName']?>项目—百度信息流统计
                </div>
                <div class="header-right">
                </div>
                </div>
            </th>
        </tr>
        <tr class="header-row light-blue-column">
            <th rowspan="2" style="text-align: center">项目名称</th>
            <th rowspan="2" style="text-align: center">账号</th>
            <th colspan="3">数据截止 <?=$data['curdate']?> 24:00</th>
            <th colspan="3">月度数据汇总 <?=$data['firstdayDate']?>---<?=$data['curdate']?></th>
        </tr>
        <tr class="date-row light-blue-column">
            <th>消耗/币</th>
            <th>表单量</th>
            <th>表单价/币</th>
            <th>消耗/币</th>
            <th>表单量</th>
            <th>表单价/币</th>
        </tr>
        <?php
           foreach ($data['data'] as $k => $v) {
                echo '<tr>';
                if ($k == 0) {
                echo '<td rowspan="' . count($data['data']) . '">' . $data['projectName'] . '</td>';
                }
                echo '<td>' . $v->subName . '</td>';
                echo '<td>' . round($v->cost) . '</td>';
                echo '<td>' . round($v->feedOCPCConversionsDetail3) . '</td>';
                echo '<td>' . round($v->cost_feed) . '</td>';
                echo '<td>' . round($v->monthCost) . '</td>';
                echo '<td>' . round($v->monthFeedOCPCConversionsDetail3) . '</td>';
                echo '<td>' . round($v->month_cost_feed) . '</td>';
                echo '</tr>';
        }
        ?>
        <tr class="summary-row">
            <td colspan="2">汇总</td>
            <td><?=round($data['yseterday_cost_sum'])?></td>
            <td><?=round($data['yseterday_feedOCPCConversionsDetail3_sum'])?></td>
            <td><?=round($data['yseterday_cost_feed_sum'])?>/条</td>
            <td><?=round($data['month_cost_sum'])?></td>
            <td><?=round($data['month_feedOCPCConversionsDetail3_sum'])?></td>
            <td><?=round($data['month_cost_feed_sum'])?>/条</td>
        </tr>
        <?php
        if ($data['show_money'] != null){
        ?>
        <tr class="summary-row">
            <td colspan="4"></td>
            <td>现金<?=number_format($data['yesterday_money'],2)?>/条</td>
            <td colspan="2"></td>
            <td>现金<?=number_format($data['month_money'],2)?>/条</td>
        </tr>
        <?php
        }
        ?>
    </table>
</div>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        let table = document.getElementById('myTable');
        let watermarkText = '旭成传媒';
        let watermarksCount = 10;

        function createWatermark(text, table) {
            let watermark = document.createElement('div');
            watermark.className = 'watermark';
            watermark.textContent = text;

            // 设置水印样式
            let angle = Math.random() * 360;
            let tableRect = table.getBoundingClientRect();
            let x = Math.random() * (table.clientWidth - 100); // 随机 x 坐标
            let y = Math.random() * (table.clientHeight - 50); // 随机 y 坐标

            watermark.style.position = 'absolute';
            watermark.style.transform = `rotate(${angle}deg)`;
            watermark.style.left = `${x}px`;
            watermark.style.top = `${y}px`;
            watermark.style.pointerEvents = 'none'; // 确保水印不会影响表格交互

            table.appendChild(watermark);
        }

        // 确保table是相对定位
        table.style.position = 'relative';

        // 创建多个水印
        for (let i = 0; i < watermarksCount; i++) {
            createWatermark(watermarkText, table);
        }
    });
</script>
</body>
</html>